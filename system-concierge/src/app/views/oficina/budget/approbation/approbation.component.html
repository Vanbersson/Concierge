<div class="flex justify-content-center bg-auto surface-500">
    <p-toast/>
    <div class="card-budget">
        <div class="flex justify-content-end m-3">
            <button pButton label="Aprovar Orçamento" size="large" (click)="approbation()"></button>
        </div>

        <div class="flex mb-1 mt-2">
            <div class="flex flex-column w-full border-1">
                <div class="flex flex-column gap-1 pl-1">
                    <span class="text-small">EMPRESA</span>
                    <span class="text-normal">NATIVA MAQUINAS E IMPLEMENTO LTDA</span>
                </div>
                <div class="border-bottom-1"></div>
                <div class="flex">
                    <div class="flex flex-column gap-1 w-2 border-right-1 pl-1">
                        <span class="text-small">DATA APROVAÇÃO</span>
                        <span class="text-normal">{{dateApprobation | date: 'dd/MM/yyyy'}}</span>
                    </div>
                    <div class="flex flex-column border-0 gap-1 pl-1">
                        <span class="text-small">APROVADO POR</span>
                        <span class="text-normal">{{clientCompany.contactName | uppercase}}</span>
                    </div>
                </div>

            </div>
            <div
                class="flex justify-content-center align-items-center flex-column border-top-1 border-right-1 border-bottom-1 w-2 text-sm p-2 gap-1 ">
                <span class="text-small">ORÇAMENTO</span>
                <span class="text-normal"><strong>Nº {{formatNumberBudget(budget.id)}}</strong></span>
            </div>
        </div>
        <div class="flex flex-column mb-1">
            <div class="flex w-full border-1">
                <div class="flex flex-column w-2 gap-1 pl-1 border-right-1">
                    <span class="text-small">Nº O.S.</span>
                    <span class="text-normal">{{vehicleEntry.numServiceOrder}}</span>
                </div>
                <div class="flex flex-column w-6 gap-1 pl-1 border-right-1">
                    <span class="text-small">CONSULTOR</span>
                    <span class="text-normal">{{vehicleEntry.nameUserAttendant | uppercase}}</span>
                </div>
                <div class="flex flex-column w-4 gap-1 pl-1 ">
                    <span class="text-small">DATA VALIDADE</span>
                    <span class="text-normal"><strong>{{budget.dateValidation | date: 'dd/MM/yyyy'}}</strong></span>
                </div>
            </div>
            <div class="flex w-full border-left-1 border-bottom-1 border-right-1 ">
                <div class="flex flex-column w-2 gap-1 pl-1 border-right-1">
                    <span class="text-small">PLACA</span>
                    <span class="text-normal">{{maskPlaca(vehicleEntry.placa) | uppercase}}</span>
                </div>
                <div class="flex flex-column w-3 gap-1 pl-1 border-right-1">
                    <span class="text-small">MODELO</span>
                    <span class="text-normal">{{vehicleEntry.modelDescription | uppercase}}</span>
                </div>
                <div class="flex flex-column w-3 gap-1 pl-1 border-right-1">
                    <span class="text-small">COR</span>
                    <span class="text-normal">{{vehicleEntry.color | uppercase}}</span>
                </div>
                <div class="flex flex-column w-3 gap-1 pl-1">
                    <span class="text-small">KM</span>
                    <span class="text-normal">{{vehicleEntry.kmEntry}}</span>
                </div>
            </div>
        </div>
        <div class="flex flex-column mb-2">
            <div class="flex w-full border-1 ">
                <div class="flex flex-column w-9 gap-1 pl-1 border-right-1">
                    <span class="text-small">CLIENTE</span>
                    <span class="text-normal">{{clientCompany.name | uppercase}}</span>
                </div>
                <div class="flex flex-column w-3 gap-1 pl-1">
                    <span class="text-small">CNPJ/CPF</span>
                    <span class="text-normal">
                        @if(clientCompany.fisjur =="Juridica"){
                        {{maskCNPJ(clientCompany.cnpj)}}
                        }@else {
                        {{maskCPF(clientCompany.cpf)}}
                        }
                    </span>
                </div>
            </div>
            <div class="flex border-left-1 border-bottom-1 border-right-1 ">
                <div class="flex flex-column w-3 gap-1 pl-1 border-right-1">
                    <span class="text-small">CEP</span>
                    <span class="text-normal">{{clientCompany.zipCode}}</span>
                </div>
                <div class="flex flex-column w-1 gap-1 pl-1 border-right-1">
                    <span class="text-small">UF</span>
                    <span class="text-normal">{{clientCompany.state | uppercase}}</span>
                </div>
                <div class="flex flex-column w-4 gap-1 pl-1 border-right-1">
                    <span class="text-small">CIDADE</span>
                    <span class="text-normal">{{clientCompany.city | uppercase}}</span>
                </div>
                <div class="flex flex-column gap-1 pl-1">
                    <span class="text-small">BAIRRO</span>
                    <span class="text-normal">{{clientCompany.neighborhood | uppercase}}</span>
                </div>
            </div>
            <div class="flex border-left-1 border-bottom-1 border-right-1">
                <div class="flex flex-column gap-1 pl-1">
                    <span class="text-small">ENDEREÇO</span>
                    <span class="text-normal">{{clientCompany.address | uppercase}} {{clientCompany.addressNumber}}</span>
                </div>
            </div>
        </div>
        <span class="text-small"><strong>SOLICITAÇOES</strong></span>
        <div class="flex flex-column">
            <table>
                <thead>
                    <tr>
                        <th style="width: 6%;">ORDEM</th>
                        <th style="width: 94%;">DESCRIÇÃO</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let req of listBudgetRequisition">
                        <td>{{req.ordem}}</td>
                        <td>{{req.description | uppercase}}</td>
                    </tr>
                </tbody>
                <tfoot></tfoot>
            </table>
        </div>
        <span class="text-small"><strong>SERVIÇOS</strong></span>
        <div class="flex flex-column">
            <table class="print-table">
                <thead>
                    <tr>
                        <th style="width: 6%;">ORDEM</th>
                        <th style="width: 54%;">DESCRIÇÃO</th>
                        <th style="width: 10%;">TEMPO</th>
                        <th style="width: 10%;">Vlr HORA</th>
                        <th style="width: 10%;">DESCONTO</th>
                        <th style="width: 10%;">TOTAL</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let serv of listBudgetServiceItem">
                        <td>{{serv.ordem}}</td>
                        <td>{{serv.description | uppercase}}</td>
                        <td>{{serv.hourService}}</td>
                        <td>{{serv.price | currency}}</td>
                        <td>{{serv.discount | currency}}</td>
                        <td>{{(serv.price * serv.hourService) - serv.discount | currency }}</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" class="text-right pr-2">
                            <strong>TOTAL DE SERVIÇOS</strong>
                        </td>
                        <td>
                            <strong>{{totalService | currency }}</strong>
                        </td>
                        <td>
                            <strong>{{totalServiceDiscount | currency }}</strong>
                        </td>
                        <td>
                            <strong>{{totalService - totalServiceDiscount | currency }}</strong>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <span class="text-small"><strong>PEÇAS</strong></span>
        <div class="flex flex-column">
            <table>
                <thead>
                    <tr>
                        <th style="width: 6%;">ORDEM</th>
                        <th style="width: 14%;">CÓDIGO</th>
                        <th style="width: 40%;">DESCRIÇÃO</th>
                        <th style="width: 10%;">QUANT.</th>
                        <th style="width: 10%;">VALOR</th>
                        <th style="width: 10%;">DESCONTO</th>
                        <th style="width: 10%;">TOTAL</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of listBudgetItem">
                        <td>{{item.ordem}}</td>
                        <td>{{item.code}}</td>
                        <td>{{item.description | uppercase }}</td>
                        <td>{{item.quantity | number:'1.2-2' }}</td>
                        <td>{{item.price | currency}}</td>
                        <td>{{item.discount | currency }}</td>
                        <td>{{(item.price * item.quantity) - item.discount | currency}}</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="4" class="text-right pr-2">
                            <strong>TOTAL DE PEÇAS</strong>
                        </td>
                        <td>
                            <strong>{{totalPart | currency }}</strong>
                        </td>
                        <td>
                            <strong>{{totalPartDiscount | currency }}</strong>
                        </td>
                        <td>
                            <strong>{{totalPart - totalPartDiscount | currency}}</strong>
                        </td>
                    </tr>

                </tfoot>
            </table>
        </div>
        <br>
        <div class="flex justify-content-end flex-wrap">
            <table class="mt-5" style="width: 300px;">
                <tr>
                    <td class="text-normal p-1">TOTAL DE SERVIÇOS</td>
                    <td class="text-normal" style="text-align: right;">
                        <strong>{{totalService - totalServiceDiscount | currency }}</strong>
                    </td>
                </tr>
                <tr>
                    <td class="text-normal p-1">TOTAL DE PEÇAS</td>
                    <td class="text-normal" style="text-align: right;">
                        <strong>{{totalPart - totalPartDiscount |currency }}</strong>
                    </td>
                </tr>
                <tr>
                    <td class="text-normal p-1">TOTAL GERAL</td>
                    <td class="text-normal" style="text-align: right;">
                        <strong>{{totalGeral |currency }}</strong>
                    </td>
                </tr>
            </table>
        </div>
        <div class="flex mt-5 mb-1">
            <span class="text-small">INFORMAÇÕES</span>
        </div>
        <div class="flex border-1 w-full h-4rem p-1 text-normal">
            {{budget.information | uppercase}}
        </div>
    </div>
</div>